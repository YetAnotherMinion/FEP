clear
clc
close('all');

true_value = 0.0033034235538775347588 + 1e-14;

LinearQuad = [
1, 0.00307795606197874827
2, 0.0032012398488085879074
3, 0.0032460179512662072111
4, 0.0032669905584314651303
5, 0.0032784198153966519727
6, 0.0032853363255043810734
7, 0.0032898166911597592939
8, 0.0032928945309421814823
9, 0.003295101327177538033
10, 0.0032967205316322542238
11, 0.0032979610873669481727
12, 0.0032989437105869121557
13, 0.0032996935950766388169
14, 0.0033003125450385291904
15, 0.0033008185866800899937
16, 0.0033012268710696439193
17, 0.0033015828432925945629
18, 0.003301876896553649493
19, 0.0033021264087365431554
20, 0.0033023563741304546963
21, 0.0033025349764740025496
22, 0.0033027035869502056019
23, 0.0033028529822277047714
24, 0.0033029811068606479071
25, 0.0033030952849919937957
26, 0.0033031969162576964479
27, 0.0033032868107514801702
28, 0.0033033694316259771574
29, 0.0033034181699052533009
30, 0.0033034950773305239713
31, 0.0033035598102043139783
32, 0.0033036180931178345428
33, 0.0033036702694911449819
34, 0.0033037080922611559985
35, 0.0033037283196437837972
36, 0.003303730781019086158
37, 0.0033037153302491284283
38, 0.0033037193032964397126
39, 0.0033037160188060712279
40, 0.0033037238035327717335
41, 0.0033036928423817541953
42, 0.0033036346136822241325
43, 0.0033035143353574709761
44, 0.0033033942750734326434
45, 0.0033033540963175035514
46, 0.0033033148173765747475
47, 0.0033033571040350863564
48, 0.0033033259587808422308
49, 0.0033034235538775347588
50, 0.0033035673061448996707
51, 0.0033035844135912498243
52, 0.0033036133448143532344
53, 0.0033035871623942896121
54, 0.0033036324446795058141
55, 0.0033036407436459942245
56, 0.0033037135378205465669
57, 0.003303681826587437538
58, 0.0033037216102328377
59, 0.0033038583504369340403
60, 0.0033038243713448822714
61, 0.0033039204520728311133
62, 0.0033039325275929349278
63, 0.0033040339913798528332
64, 0.0033039591480737940873
65, 0.0033038786226449591392
66, 0.0033038308472299890775
67, 0.0033035844046817022454
68, 0.0033030282691988120669
69, 0.0033024982596733375856
70, 0.0033020949797959104136
71, 0.0033017573279068442547
72, 0.0033013405718160821617
73, 0.0033007859227343972278
74, 0.0033001614304079465029
75, 0.0032995085309423521913
76, 0.0032987005786392158656
77, 0.0032978007399715411098
78, 0.0032968171049180994454
79, 0.003295895463754105071
];

QuadraticQuad = [
1, 0.0033018411083160885411
2, 0.0033040797805787796952
3, 0.0033043268739743050441
4, 0.0033044238119337779325
5, 0.0033044421669917042016
6, 0.0033044873550554694497
7, 0.0033044461369896565434
8, 0.0033044682417990782312
9, 0.0033044678691458570161
10, 0.0033044540599760901384
11, 0.0033044761267206563052
12, 0.0033044723853653617217
13, 0.0033044798803323143475
14, 0.0033045721215689705802
15, 0.0033045299640889719099
16, 0.0033045068381323812294
17, 0.0033044608745473290357
18, 0.0033044753946781819237
19, 0.0033044721752453066858
20, 0.0033044500107730560672
21, 0.0033044373615141145635
22, 0.003304503393156783906
23, 0.0033041118433325511287
24, 0.0033039307925206494281
25, 0.0033039738985727426686
26, 0.0033038651987382307469
27, 0.003303875358797198937
28, 0.0033039935333388590483
29, 0.0033038701879597653574
30, 0.0033033249158996086034
31, 0.0033024662089958045988
32, 0.0033018789369994232079
33, 0.003300463912704969336
34, 0.0032965936095185107563
35, 0.0032936126848599040461
36, 0.0032907066437549365237
37, 0.0032876152802393393548
38, 0.0032830097466778457825
39, 0.0032787063224386336739
40, 0.0032728173486112981626
41, 0.0032650831232649297348
42, 0.003259329600567686773
43, 0.0032548789924937465874
44, 0.0032522019139316214915
45, 0.0032549963048203811936
46, 0.003262041365109425578
47, 0.00327346422304562127
48, 0.0032805381350232473009
49, 0.0032766041441731831758
50, 0.0032625705967790213924
51, 0.0032471146652139379167
52, 0.003232445417643994498
53, 0.0032157057014529119403
54, 0.0031936056788477063147
55, 0.0031674897257406545333
56, 0.0031394383963914166899
57, 0.0031132279718067740366
58, 0.0030856186512628965175
59, 0.0030560521850674063522
60, 0.0030294428537236701288
61, 0.0030056778590885021608
62, 0.0029827763925386512403
63, 0.0029611122966081843133
64, 0.0029404076337349667643
65, 0.0029212386848677337516
66, 0.0029036365361530705291
67, 0.0028881869494119870138
68, 0.0028726374923276156749
69, 0.0028565804479613226066
70, 0.0028414667068964211301
71, 0.00282598693036136819
72, 0.0028084863693304466629
73, 0.0027903917519556398208
74, 0.0027732409526734455064
75, 0.002755368031270357624
76, 0.0027377455383038409344
77, 0.0027207324309115074427
78, 0.0027073401523452591579
79, 0.0026984254959165382588
];

LinearTri = [
1, 0.0031070481263745794789
2, 0.003188118984689492473
3, 0.003230484585712799922
4, 0.0032540616589111456304
5, 0.0032681702958308293805
6, 0.003277238119935083592
7, 0.0032833140454753555366
8, 0.0032875828889727697936
9, 0.0032906708999268122033
10, 0.0032930096699277625234
11, 0.0032947793284477271993
12, 0.0032961653823414993787
13, 0.0032973030116343294768
14, 0.0032982040667485961263
15, 0.0032989627529709324681
16, 0.0032996066541606168011
17, 0.0033001283430856452258
18, 0.0033005893654700483621
19, 0.0033009760244106902197
20, 0.0033013472492424110472
21, 0.003301542994459602965
22, 0.0033014714143501482091
23, 0.0033010214653602936059
24, 0.0033010187380851266185
25, 0.0033012029091532002489
26, 0.0033013766455176900456
27, 0.0033012720087398327029
28, 0.0033013506360233344644
29, 0.0033014878502508849742
30, 0.0033013851021507674421
31, 0.0033013397454291016145
32, 0.0033021756141510261173
33, 0.0033026551773211133486
34, 0.0033027122363007877133
35, 0.0033029425655242391005
36, 0.0033028518133673477435
37, 0.0033028624195440316191
38, 0.0033029530389585642046
39, 0.0033029210880484039664
40, 0.0033026053915723549599
41, 0.0033021456967367401707
42, 0.0033017144324847961037
43, 0.0033004402143378855188
44, 0.0032997150350658967406
45, 0.0032988897645980490986
46, 0.0032968342895821306331
47, 0.0032952358705803422821
48, 0.0032930237132416093938
49, 0.003289197934314581212
50, 0.0032881805263981428791
51, 0.0032807707305106828879
52, 0.0032665517125025065638
53, 0.0032534357965917771842
54, 0.0032416590996504541546
55, 0.0032314836693965085478
56, 0.0032223252994693003283
57, 0.0032161373239773809359
58, 0.0032080746836144653777
59, 0.0031900900151509269803
60, 0.0031751485305708026033
61, 0.0031633868637876176241
62, 0.0031572958160568779552
63, 0.0031630664676647337295
64, 0.0031690823624430206236
65, 0.0031692620153619087409
66, 0.0031823549008828245881
67, 0.0031898266018705167396
68, 0.0031897123326314947601
69, 0.0031833486091850846621
70, 0.0031723160523427816962
71, 0.0031580931293602293973
72, 0.0031419886077458858073
73, 0.0031191554691438173018
74, 0.0030942572388814948772
75, 0.0030698385802408545767
76, 0.003046468465963686565
77, 0.0030241790100430736808
78, 0.0030001089394951284232
79, 0.0029756349760336670875
];

QuadraticTri = [
1, 0.0032979363214041086325
2, 0.0033033771658881254212
3, 0.0033041600001692751805
4, 0.0033043733519544748849
5, 0.0033044355819800137579
6, 0.0033045946985160736496
7, 0.0033036765100035100917
8, 0.0033034684845723145084
9, 0.0033030255099074554669
10, 0.0033034422055968270734
11, 0.0033032641705456207946
12, 0.0033033148608794340485
13, 0.0033025812416414574574
14, 0.0033005970310601277264
15, 0.0032993952662733164356
16, 0.003288484216908940834
17, 0.0032652058566485968674
18, 0.0032280603398283937676
19, 0.0032121038150056918474
20, 0.0031653857406080507415
21, 0.0031539168538465326384
22, 0.0031747165804711699987
23, 0.0032166244310014393583
24, 0.0031895250111335414836
25, 0.0031222947715482006134
26, 0.0030502222709280833561
27, 0.0029668635611664272676
28, 0.0028854736380819652475
29, 0.0028291620054055181301
30, 0.0028002367852022341799
31, 0.0027556570032431062026
32, 0.0026951872046589030359
33, 0.0026443519490640166915
34, 0.0025975847387272716325
35, 0.0025511046026420671103
36, 0.0024992956319834663294
37, 0.0024386103821850886077
38, 0.0023725765126730875149
39, 0.0022958299015565131369
40, 0.0021966083974659976821
41, 0.0020892240367134792475
42, 0.0020024351443383645033
43, 0.0019205694203799558977
44, 0.0018434096313151126633
45, 0.0017766645702420424523
46, 0.0017132275818346795037
47, 0.0016506926834508907614
48, 0.0015916590093849115103
49, 0.001543554634390602049
50, 0.0015006513031371462256
51, 0.0014617967241844099374
52, 0.0014176265111799607292
53, 0.0013727855823074586097
54, 0.0013308671256463426233
55, 0.0012970012367743580326
56, 0.0012633039174013383985
57, 0.0012316902515914951617
58, 0.0012000695920872054417
59, 0.0011693397377283368949
60, 0.0011430797150087813191
61, 0.001118775701416018821
62, 0.0010956826389449079995
63, 0.0010759990736718451094
64, 0.0010593939736241683204
65, 0.0010412662272756521842
66, 0.0010238144172450827293
67, 0.0010078270005849268402
68, 0.0009930596679709000757
69, 0.00098121885237921696934
70, 0.0009751520277815849385
71, 0.00097401772523784003327
72, 0.00097549899968118222553
73, 0.00097896438136169192795
74, 0.00098243238413069523124
75, 0.00098462934496497097128
76, 0.00098429959469839025353
77, 0.00098072260002656386907
78, 0.00097444006239693194225
79, 0.00096611543160072838477
];

SerendipityQuad = [
1, 0.0033016272860576551147
2, 0.003304027103719380052
3, 0.0033043085711936658749
4, 0.0033044321842415494764
5, 0.0033044354350770807974
6, 0.0033044527148084899999
7, 0.0033044285753108400792
8, 0.0033044587924768182435
9, 0.0033044877775371085324
10, 0.0033044827744622240311
11, 0.0033045161169327347261
12, 0.0033044459889621357468
13, 0.0033044826824383203429
14, 0.003304473901239792042
15, 0.0033044859588792952106
16, 0.0033044458872444324761
17, 0.0033045009391487133697
18, 0.0033044179811430249294
19, 0.0033042978325973932502
20, 0.0033042243355906135947
21, 0.0033040565726605974212
22, 0.0033037827839555089157
23, 0.0033038310253644975235
24, 0.0033037088047520903056
25, 0.0033036959546247088651
26, 0.003303551433079115595
27, 0.003303527992647412731
28, 0.0033038617961222665857
29, 0.0033041076592818046341
30, 0.0033042333726438872718
31, 0.0033041587251823305998
32, 0.0033040980909073178022
33, 0.0033038670895043495065
34, 0.0033035588929522944138
35, 0.0033035258760391364961
36, 0.0033035595551971419157
37, 0.0033036513050522095178
38, 0.0033035505436280585174
39, 0.0033030945150333010721
40, 0.0033024111679862081653
41, 0.0033017659761783767561
42, 0.0033010591366159887719
43, 0.0033008337509927662169
44, 0.003299606288220195173
45, 0.0032971253946634982053
46, 0.0032910568489568177084
47, 0.0032828085177038519166
48, 0.003274533687600986176
49, 0.0032677781884571767759
50, 0.0032617309504969238011
51, 0.0032562786822508127393
52, 0.00325146953255564964
53, 0.0032476110504856179305
54, 0.0032449491120591900627
55, 0.0032419237560791249429
56, 0.00323575523145094553
57, 0.0032277060313960375705
58, 0.0032206122455435987756
59, 0.0032130449641913460916
60, 0.0032071813751579510664
61, 0.0032089653636019873154
62, 0.0032120032019033405678
63, 0.0032089182571356645972
64, 0.0031946887673051783778
65, 0.0031744904093661441453
66, 0.0031535188665515983923
67, 0.0031314310237292803177
68, 0.0031076232319929477516
69, 0.0030856558666477787965
70, 0.0030661966309214303168
71, 0.0030447650531250187653
72, 0.0030231119904307887994
73, 0.0029981049807773904256
74, 0.0029734506801364873722
75, 0.0029505111973782871711
76, 0.0029266405952434156393
77, 0.0029061460368987922578
78, 0.0028858222357057293668
79, 0.0028642612570630270052
];

strain_energy_fig = figure();
hold on
handle1 = plot(SerendipityQuad(:,1), SerendipityQuad(:,2), 'kd-');
set(handle1, 'linewidth', 2)
hold on
handle2 = plot(QuadraticQuad(:,1), QuadraticQuad(:,2), 'rd-');
set(handle2, 'linewidth', 2)
hold on
handle3 = plot(LinearQuad(:,1), LinearQuad(:,2), 'bd-');
set(handle3, 'linewidth', 2)
hold on
handle4 = plot(QuadraticTri(:,1), QuadraticTri(:,2), 'gd-');
set(handle4, 'linewidth', 2)
hold on
handle5 = plot(LinearTri(:,1), LinearTri(:,2), 'md-');
set(handle5, 'linewidth', 2)

set(gca, 'fontsize', 16)
title('Convergence for Constant Body Forces over 2x2 unit domain')
xlabel('1/h');
ylabel('Strain Energy');

legend('SerendipityQuad', 'QuadraticQuad', 'LinearQuad', 'QuadraticTri', 'LinearTri', 'Location', 'southeast');
ylim([0.003, 0.00335]);

constant_body_force_2x2_linear_quad = [
1, 7, 0.00307795606197874827
2, 17, 0.0032012398488085879074
3, 31, 0.0032460179512662072111
4, 49, 0.0032669905584314651303
5, 71, 0.0032784198153966519727
6, 97, 0.0032853363255043810734
7, 127, 0.0032898166911597592939
8, 161, 0.0032928945309421814823
9, 199, 0.003295101327177538033
10, 241, 0.0032967205316322542238
11, 287, 0.0032979610873669481727
12, 337, 0.0032989437105869121557
13, 391, 0.0032996935950766388169
14, 449, 0.0033003125450385291904
15, 511, 0.0033008185866800899937
16, 577, 0.0033012268710696439193
17, 647, 0.0033015828432925945629
18, 721, 0.003301876896553649493
19, 799, 0.0033021264087365431554
20, 881, 0.0033023563741304546963
21, 967, 0.0033025349764740025496
22, 1057, 0.0033027035869502056019
23, 1151, 0.0033028529822277047714
24, 1249, 0.0033029811068606479071
25, 1351, 0.0033030952849919937957
26, 1457, 0.0033031969162576964479
27, 1567, 0.0033032868107514801702
28, 1681, 0.0033033694316259771574
29, 1799, 0.0033034181699052533009
30, 1921, 0.0033034950773305239713
31, 2047, 0.0033035598102043139783
32, 2177, 0.0033036180931178345428
33, 2311, 0.0033036702694911449819
34, 2449, 0.0033037080922611559985
35, 2591, 0.0033037283196437837972
36, 2737, 0.003303730781019086158
37, 2887, 0.0033037153302491284283
38, 3041, 0.0033037193032964397126
39, 3199, 0.0033037160188060712279
40, 3361, 0.0033037238035327717335
41, 3527, 0.0033036928423817541953
42, 3697, 0.0033036346136822241325
43, 3871, 0.0033035143353574709761
44, 4049, 0.0033033942750734326434
45, 4231, 0.0033033540963175035514
46, 4417, 0.0033033148173765747475
47, 4607, 0.0033033571040350863564
48, 4801, 0.0033033259587808422308
49, 4999, 0.0033034235538775347588
50, 5201, 0.0033035673061448996707
51, 5407, 0.0033035844135912498243
52, 5617, 0.0033036133448143532344
53, 5831, 0.0033035871623942896121
54, 6049, 0.0033036324446795058141
55, 6271, 0.0033036407436459942245
56, 6497, 0.0033037135378205465669
57, 6727, 0.003303681826587437538
58, 6961, 0.0033037216102328377
59, 7199, 0.0033038583504369340403
60, 7441, 0.0033038243713448822714
61, 7687, 0.0033039204520728311133
62, 7937, 0.0033039325275929349278
63, 8191, 0.0033040339913798528332
64, 8449, 0.0033039591480737940873
65, 8711, 0.0033038786226449591392
66, 8977, 0.0033038308472299890775
67, 9247, 0.0033035844046817022454
68, 9521, 0.0033030282691988120669
69, 9799, 0.0033024982596733375856
70, 10081, 0.0033020949797959104136
71, 10367, 0.0033017573279068442547
72, 10657, 0.0033013405718160821617
73, 10951, 0.0033007859227343972278
74, 11249, 0.0033001614304079465029
75, 11551, 0.0032995085309423521913
76, 11857, 0.0032987005786392158656
77, 12167, 0.0032978007399715411098
78, 12481, 0.0032968171049180994454
79, 12799, 0.003295895463754105071
];

constant_body_force_2x2_quadratic_quad = [
1, 22, 0.0033018411083160885411
2, 58, 0.0033040797805787796952
3, 110, 0.0033043268739743050441
4, 178, 0.0033044238119337779325
5, 262, 0.0033044421669917042016
6, 362, 0.0033044873550554694497
7, 478, 0.0033044461369896565434
8, 610, 0.0033044682417990782312
9, 758, 0.0033044678691458570161
10, 922, 0.0033044540599760901384
11, 1102, 0.0033044761267206563052
12, 1298, 0.0033044723853653617217
13, 1510, 0.0033044798803323143475
14, 1738, 0.0033045721215689705802
15, 1982, 0.0033045299640889719099
16, 2242, 0.0033045068381323812294
17, 2518, 0.0033044608745473290357
18, 2810, 0.0033044753946781819237
19, 3118, 0.0033044721752453066858
20, 3442, 0.0033044500107730560672
21, 3782, 0.0033044373615141145635
22, 4138, 0.003304503393156783906
23, 4510, 0.0033041118433325511287
24, 4898, 0.0033039307925206494281
25, 5302, 0.0033039738985727426686
26, 5722, 0.0033038651987382307469
27, 6158, 0.003303875358797198937
28, 6610, 0.0033039935333388590483
29, 7078, 0.0033038701879597653574
30, 7562, 0.0033033249158996086034
31, 8062, 0.0033024662089958045988
32, 8578, 0.0033018789369994232079
33, 9110, 0.003300463912704969336
34, 9658, 0.0032965936095185107563
35, 10222, 0.0032936126848599040461
36, 10802, 0.0032907066437549365237
37, 11398, 0.0032876152802393393548
38, 12010, 0.0032830097466778457825
39, 12638, 0.0032787063224386336739
40, 13282, 0.0032728173486112981626
41, 13942, 0.0032650831232649297348
42, 14618, 0.003259329600567686773
43, 15310, 0.0032548789924937465874
44, 16018, 0.0032522019139316214915
45, 16742, 0.0032549963048203811936
46, 17482, 0.003262041365109425578
47, 18238, 0.00327346422304562127
48, 19010, 0.0032805381350232473009
49, 19798, 0.0032766041441731831758
50, 20602, 0.0032625705967790213924
51, 21422, 0.0032471146652139379167
52, 22258, 0.003232445417643994498
53, 23110, 0.0032157057014529119403
54, 23978, 0.0031936056788477063147
55, 24862, 0.0031674897257406545333
56, 25762, 0.0031394383963914166899
57, 26678, 0.0031132279718067740366
58, 27610, 0.0030856186512628965175
59, 28558, 0.0030560521850674063522
60, 29522, 0.0030294428537236701288
61, 30502, 0.0030056778590885021608
62, 31498, 0.0029827763925386512403
63, 32510, 0.0029611122966081843133
64, 33538, 0.0029404076337349667643
65, 34582, 0.0029212386848677337516
66, 35642, 0.0029036365361530705291
67, 36718, 0.0028881869494119870138
68, 37810, 0.0028726374923276156749
69, 38918, 0.0028565804479613226066
70, 40042, 0.0028414667068964211301
71, 41182, 0.00282598693036136819
72, 42338, 0.0028084863693304466629
73, 43510, 0.0027903917519556398208
74, 44698, 0.0027732409526734455064
75, 45902, 0.002755368031270357624
76, 47122, 0.0027377455383038409344
77, 48358, 0.0027207324309115074427
78, 49610, 0.0027073401523452591579
79, 50878, 0.0026984254959165382588
];

constant_body_force_2x2_linear_tri = [
1, 7, 0.0031070481263745794789
2, 17, 0.003188118984689492473
3, 31, 0.003230484585712799922
4, 49, 0.0032540616589111456304
5, 71, 0.0032681702958308293805
6, 97, 0.003277238119935083592
7, 127, 0.0032833140454753555366
8, 161, 0.0032875828889727697936
9, 199, 0.0032906708999268122033
10, 241, 0.0032930096699277625234
11, 287, 0.0032947793284477271993
12, 337, 0.0032961653823414993787
13, 391, 0.0032973030116343294768
14, 449, 0.0032982040667485961263
15, 511, 0.0032989627529709324681
16, 577, 0.0032996066541606168011
17, 647, 0.0033001283430856452258
18, 721, 0.0033005893654700483621
19, 799, 0.0033009760244106902197
20, 881, 0.0033013472492424110472
21, 967, 0.003301542994459602965
22, 1057, 0.0033014714143501482091
23, 1151, 0.0033010214653602936059
24, 1249, 0.0033010187380851266185
25, 1351, 0.0033012029091532002489
26, 1457, 0.0033013766455176900456
27, 1567, 0.0033012720087398327029
28, 1681, 0.0033013506360233344644
29, 1799, 0.0033014878502508849742
30, 1921, 0.0033013851021507674421
31, 2047, 0.0033013397454291016145
32, 2177, 0.0033021756141510261173
33, 2311, 0.0033026551773211133486
34, 2449, 0.0033027122363007877133
35, 2591, 0.0033029425655242391005
36, 2737, 0.0033028518133673477435
37, 2887, 0.0033028624195440316191
38, 3041, 0.0033029530389585642046
39, 3199, 0.0033029210880484039664
40, 3361, 0.0033026053915723549599
41, 3527, 0.0033021456967367401707
42, 3697, 0.0033017144324847961037
43, 3871, 0.0033004402143378855188
44, 4049, 0.0032997150350658967406
45, 4231, 0.0032988897645980490986
46, 4417, 0.0032968342895821306331
47, 4607, 0.0032952358705803422821
48, 4801, 0.0032930237132416093938
49, 4999, 0.003289197934314581212
50, 5201, 0.0032881805263981428791
51, 5407, 0.0032807707305106828879
52, 5617, 0.0032665517125025065638
53, 5831, 0.0032534357965917771842
54, 6049, 0.0032416590996504541546
55, 6271, 0.0032314836693965085478
56, 6497, 0.0032223252994693003283
57, 6727, 0.0032161373239773809359
58, 6961, 0.0032080746836144653777
59, 7199, 0.0031900900151509269803
60, 7441, 0.0031751485305708026033
61, 7687, 0.0031633868637876176241
62, 7937, 0.0031572958160568779552
63, 8191, 0.0031630664676647337295
64, 8449, 0.0031690823624430206236
65, 8711, 0.0031692620153619087409
66, 8977, 0.0031823549008828245881
67, 9247, 0.0031898266018705167396
68, 9521, 0.0031897123326314947601
69, 9799, 0.0031833486091850846621
70, 10081, 0.0031723160523427816962
71, 10367, 0.0031580931293602293973
72, 10657, 0.0031419886077458858073
73, 10951, 0.0031191554691438173018
74, 11249, 0.0030942572388814948772
75, 11551, 0.0030698385802408545767
76, 11857, 0.003046468465963686565
77, 12167, 0.0030241790100430736808
78, 12481, 0.0030001089394951284232
79, 12799, 0.0029756349760336670875
];

constant_body_force_2x2_quadratic_tri = [
1, 22, 0.0032979363214041086325
2, 58, 0.0033033771658881254212
3, 110, 0.0033041600001692751805
4, 178, 0.0033043733519544748849
5, 262, 0.0033044355819800137579
6, 362, 0.0033045946985160736496
7, 478, 0.0033036765100035100917
8, 610, 0.0033034684845723145084
9, 758, 0.0033030255099074554669
10, 922, 0.0033034422055968270734
11, 1102, 0.0033032641705456207946
12, 1298, 0.0033033148608794340485
13, 1510, 0.0033025812416414574574
14, 1738, 0.0033005970310601277264
15, 1982, 0.0032993952662733164356
16, 2242, 0.003288484216908940834
17, 2518, 0.0032652058566485968674
18, 2810, 0.0032280603398283937676
19, 3118, 0.0032121038150056918474
20, 3442, 0.0031653857406080507415
21, 3782, 0.0031539168538465326384
22, 4138, 0.0031747165804711699987
23, 4510, 0.0032166244310014393583
24, 4898, 0.0031895250111335414836
25, 5302, 0.0031222947715482006134
26, 5722, 0.0030502222709280833561
27, 6158, 0.0029668635611664272676
28, 6610, 0.0028854736380819652475
29, 7078, 0.0028291620054055181301
30, 7562, 0.0028002367852022341799
31, 8062, 0.0027556570032431062026
32, 8578, 0.0026951872046589030359
33, 9110, 0.0026443519490640166915
34, 9658, 0.0025975847387272716325
35, 10222, 0.0025511046026420671103
36, 10802, 0.0024992956319834663294
37, 11398, 0.0024386103821850886077
38, 12010, 0.0023725765126730875149
39, 12638, 0.0022958299015565131369
40, 13282, 0.0021966083974659976821
41, 13942, 0.0020892240367134792475
42, 14618, 0.0020024351443383645033
43, 15310, 0.0019205694203799558977
44, 16018, 0.0018434096313151126633
45, 16742, 0.0017766645702420424523
46, 17482, 0.0017132275818346795037
47, 18238, 0.0016506926834508907614
48, 19010, 0.0015916590093849115103
49, 19798, 0.001543554634390602049
50, 20602, 0.0015006513031371462256
51, 21422, 0.0014617967241844099374
52, 22258, 0.0014176265111799607292
53, 23110, 0.0013727855823074586097
54, 23978, 0.0013308671256463426233
55, 24862, 0.0012970012367743580326
56, 25762, 0.0012633039174013383985
57, 26678, 0.0012316902515914951617
58, 27610, 0.0012000695920872054417
59, 28558, 0.0011693397377283368949
60, 29522, 0.0011430797150087813191
61, 30502, 0.001118775701416018821
62, 31498, 0.0010956826389449079995
63, 32510, 0.0010759990736718451094
64, 33538, 0.0010593939736241683204
65, 34582, 0.0010412662272756521842
66, 35642, 0.0010238144172450827293
67, 36718, 0.0010078270005849268402
68, 37810, 0.0009930596679709000757
69, 38918, 0.00098121885237921696934
70, 40042, 0.0009751520277815849385
71, 41182, 0.00097401772523784003327
72, 42338, 0.00097549899968118222553
73, 43510, 0.00097896438136169192795
74, 44698, 0.00098243238413069523124
75, 45902, 0.00098462934496497097128
76, 47122, 0.00098429959469839025353
77, 48358, 0.00098072260002656386907
78, 49610, 0.00097444006239693194225
79, 50878, 0.00096611543160072838477
];

constant_body_force_2x2_quadratic_serendipity = [
1, 18, 0.0033016272860576551147
2, 46, 0.003304027103719380052
3, 86, 0.0033043085711936658749
4, 138, 0.0033044321842415494764
5, 202, 0.0033044354350770807974
6, 278, 0.0033044527148084899999
7, 366, 0.0033044285753108400792
8, 466, 0.0033044587924768182435
9, 578, 0.0033044877775371085324
10, 702, 0.0033044827744622240311
11, 838, 0.0033045161169327347261
12, 986, 0.0033044459889621357468
13, 1146, 0.0033044826824383203429
14, 1318, 0.003304473901239792042
15, 1502, 0.0033044859588792952106
16, 1698, 0.0033044458872444324761
17, 1906, 0.0033045009391487133697
18, 2126, 0.0033044179811430249294
19, 2358, 0.0033042978325973932502
20, 2602, 0.0033042243355906135947
21, 2858, 0.0033040565726605974212
22, 3126, 0.0033037827839555089157
23, 3406, 0.0033038310253644975235
24, 3698, 0.0033037088047520903056
25, 4002, 0.0033036959546247088651
26, 4318, 0.003303551433079115595
27, 4646, 0.003303527992647412731
28, 4986, 0.0033038617961222665857
29, 5338, 0.0033041076592818046341
30, 5702, 0.0033042333726438872718
31, 6078, 0.0033041587251823305998
32, 6466, 0.0033040980909073178022
33, 6866, 0.0033038670895043495065
34, 7278, 0.0033035588929522944138
35, 7702, 0.0033035258760391364961
36, 8138, 0.0033035595551971419157
37, 8586, 0.0033036513050522095178
38, 9046, 0.0033035505436280585174
39, 9518, 0.0033030945150333010721
40, 10002, 0.0033024111679862081653
41, 10498, 0.0033017659761783767561
42, 11006, 0.0033010591366159887719
43, 11526, 0.0033008337509927662169
44, 12058, 0.003299606288220195173
45, 12602, 0.0032971253946634982053
46, 13158, 0.0032910568489568177084
47, 13726, 0.0032828085177038519166
48, 14306, 0.003274533687600986176
49, 14898, 0.0032677781884571767759
50, 15502, 0.0032617309504969238011
51, 16118, 0.0032562786822508127393
52, 16746, 0.00325146953255564964
53, 17386, 0.0032476110504856179305
54, 18038, 0.0032449491120591900627
55, 18702, 0.0032419237560791249429
56, 19378, 0.00323575523145094553
57, 20066, 0.0032277060313960375705
58, 20766, 0.0032206122455435987756
59, 21478, 0.0032130449641913460916
60, 22202, 0.0032071813751579510664
61, 22938, 0.0032089653636019873154
62, 23686, 0.0032120032019033405678
63, 24446, 0.0032089182571356645972
64, 25218, 0.0031946887673051783778
65, 26002, 0.0031744904093661441453
66, 26798, 0.0031535188665515983923
67, 27606, 0.0031314310237292803177
68, 28426, 0.0031076232319929477516
69, 29258, 0.0030856558666477787965
70, 30102, 0.0030661966309214303168
71, 30958, 0.0030447650531250187653
72, 31826, 0.0030231119904307887994
73, 32706, 0.0029981049807773904256
74, 33598, 0.0029734506801364873722
75, 34502, 0.0029505111973782871711
76, 35418, 0.0029266405952434156393
77, 36346, 0.0029061460368987922578
78, 37286, 0.0028858222357057293668
79, 38238, 0.0028642612570630270052
];

larger_domain = figure();
hold on
handle1 = plot(constant_body_force_2x2_quadratic_serendipity(:,2), constant_body_force_2x2_quadratic_serendipity(:,3), 'kd-');
set(handle1, 'linewidth', 2)
hold on
handle2 = plot(constant_body_force_2x2_quadratic_quad(:,2), constant_body_force_2x2_quadratic_quad(:,3), 'rd-');
set(handle2, 'linewidth', 2)
hold on
handle3 = plot(constant_body_force_2x2_linear_quad(:,2), constant_body_force_2x2_linear_quad(:,3), 'bd-');
set(handle3, 'linewidth', 2)
hold on
handle4 = plot(constant_body_force_2x2_quadratic_tri(:,2), constant_body_force_2x2_quadratic_tri(:,3), 'gd-');
set(handle4, 'linewidth', 2)
hold on
handle5 = plot(constant_body_force_2x2_linear_tri(:,2), constant_body_force_2x2_linear_tri(:,3), 'md-');
set(handle5, 'linewidth', 2)

set(gca, 'fontsize', 16)
title('Convergence for Constant Body Forces over 2x2 unit domain')
xlabel('Degrees of freedom');
ylabel('Strain Energy');

legend('SerendipityQuad', 'QuadraticQuad', 'LinearQuad', 'QuadraticTri', 'LinearTri', 'Location', 'southeast');
ylim([0.002, 0.0035]);

linear_body_force_linear_quad = [
1, 34.027777777777785673
2, 39.871046307165492806
3, 41.141665113381058916
4, 41.602947580429727736
5, 41.820148538393461024
6, 41.939307750084466875
7, 42.01162315793077795
8, 42.058770645534565347
9, 42.091203528986490312
10, 42.114463647156348713
11, 42.13170668623264703
12, 42.144844178325747919
13, 42.155079605140450383
14, 42.16321131333527461
15, 42.16977666655193957
16, 42.175155188630782277
17, 42.179615197556159956
18, 42.183357672555693796
19, 42.186526100486361202
20, 42.18923049028335015
21, 42.191561424275363379
22, 42.193580125576353623
23, 42.195341898556776528
24, 42.196885832136253214
25, 42.198234258568426469
26, 42.199417310227467226
27, 42.200508225722458633
28, 42.201470762522632185
29, 42.20234915286101085
30, 42.203164158420165109
31, 42.203944176140296918
32, 42.2045910140604974
33, 42.20517055216465252
34, 42.205687391686019794
35, 42.206170110294280562
36, 42.206597327534282726
37, 42.207012288083326723
38, 42.207425218210296691
39, 42.207814274945235411
40, 42.207996554865012229
41, 42.208248708246863146
42, 42.208560142808451587
43, 42.208853101646177208
44, 42.209077131139707717
45, 42.209316557104820333
46, 42.209584469831426645
47, 42.209785721593036101
48, 42.20996951705841127
49, 42.210142195383241415
50, 42.210302632085188179
51, 42.210427423405249669
52, 42.210515109529666233
53, 42.210579053424311269
54, 42.210641962108425673
55, 42.210670979086771126
56, 42.210722688597869023
57, 42.210802171950831507
58, 42.210915925488357914
59, 42.211058922603797328
60, 42.211126921088713004
61, 42.211118213692955692
62, 42.21087983941596633
63, 42.210291624122817211
64, 42.209315873574936973
65, 42.20806784324826566
66, 42.206643656556899202
67, 42.205217215503694206
68, 42.204066916989042113
69, 42.203040586739696494
70, 42.202195546826239081
71, 42.20181880447869105
72, 42.201834038112295389
73, 42.201959780213343265
74, 42.202091184489766817
75, 42.202279761303778116
76, 42.202204253397148648
77, 42.201694392342425033
78, 42.201199425451711988
79, 42.20041735474303124
];

linear_body_force_quadratic_quad = [
1, 42.038691363567032511
2, 42.202100687599724438
3, 42.211759342803858885
4, 42.213486404568783428
5, 42.213978916812912701
6, 42.214165110447595453
7, 42.214246146413586303
8, 42.214284857712229382
9, 42.214310075002622114
10, 42.214324269364666975
11, 42.214330251051968901
12, 42.214311028502379486
13, 42.214262058348786866
14, 42.214353134703650028
15, 42.214420703471823515
16, 42.21441004899136118
17, 42.214417635929024186
18, 42.214382954135970749
19, 42.21436817010381759
20, 42.214386654181467406
21, 42.214396878861158768
22, 42.214224842497699797
23, 42.214267091798312492
24, 42.214185755125122057
25, 42.213992902223743897
26, 42.213763011684463322
27, 42.213630722818919594
28, 42.213431294355672208
29, 42.213416365950138243
30, 42.213272086239221892
31, 42.212601076820000401
32, 42.210225214679880423
33, 42.208710826973977248
34, 42.202748676873582667
35, 42.192500021778982955
36, 42.17607838031526768
37, 42.137539170872614136
38, 42.107544274415211305
39, 42.04652571856462373
40, 41.945341999272379496
41, 41.747608033872971589
42, 41.529492784258145832
43, 41.347349705626996297
44, 41.09422947680212701
45, 40.778145899745268821
46, 40.439703220049409538
47, 40.057545412521157857
48, 39.685736906089275067
49, 39.412593936126505412
50, 39.306384719159822794
51, 39.274248044750869724
52, 39.203917349321692143
53, 39.177971239173977835
54, 39.38997456481999393
55, 39.832972328555001695
56, 40.34073356712523406
57, 40.796185056072239661
58, 41.214306720852057708
59, 41.512689670320106927
60, 41.663606160461760908
61, 41.692758418252232389
62, 41.604356866757314037
63, 41.402971210331621421
64, 41.120998938801434974
65, 40.809052147066374516
66, 40.48044581247849294
67, 40.14293709808928412
68, 39.80682556931541427
69, 39.476797785717309353
70, 39.152637480408600368
71, 38.815279727588062997
72, 38.454907517652820559
73, 38.09549991488992049
74, 37.715784146607973071
75, 37.343261012689268341
76, 37.01073035028628766
77, 36.670464960857117376
78, 36.282652488424396608
79, 35.840767268105743426
];

linear_body_force_linear_tri = [
1, 34.585136375816908583
2, 39.808238248559653982
3, 41.005772228965568615
4, 41.481560572321811264
5, 41.721788666777960941
6, 41.860540222782717024
7, 41.948011721503860372
8, 42.006703865068324433
9, 42.047977040892192235
10, 42.078097145255185296
11, 42.100741061294343126
12, 42.118188494666149779
13, 42.131913099501403508
14, 42.142911927708134101
15, 42.151907647801266421
16, 42.159272985017928193
17, 42.165354239049435137
18, 42.17057685664254052
19, 42.174942799257621573
20, 42.178779995029685779
21, 42.182015358663690563
22, 42.184720063219948827
23, 42.187223211601882156
24, 42.189395639127262427
25, 42.191325536420919207
26, 42.193028124822369307
27, 42.194552165579949587
28, 42.195904024410296529
29, 42.197102758198852257
30, 42.198104442917816925
31, 42.199165987749978513
32, 42.19996087794658024
33, 42.200717424254186483
34, 42.201163845445414324
35, 42.201477419667718038
36, 42.20203408970212422
37, 42.202032460425364491
38, 42.202329974294258363
39, 42.201825923678356389
40, 42.199953425241275795
41, 42.196335815450446205
42, 42.190956847200858704
43, 42.185421570944754421
44, 42.1719631615910302
45, 42.174758714301269436
46, 42.163534777588154157
47, 42.144941489821874825
48, 42.101885052631530471
49, 42.071372357344493764
50, 41.990491023638028878
51, 41.887234233094027047
52, 41.849157302680062287
53, 41.783889010054735991
54, 41.588829168752589283
55, 41.375022622388087257
56, 41.228053126051761978
57, 41.111748048655222476
58, 40.994267416434453821
59, 40.886518398975397304
60, 40.751053387312055065
61, 40.641268530086726685
62, 40.432664379128588905
63, 40.267508373506252894
64, 40.14409776035199684
65, 40.039457927012925609
66, 39.993059418024934359
67, 40.020517742024267704
68, 39.82093541220849886
69, 39.762720279011247726
70, 39.81331223628064464
71, 39.944679905033588341
72, 40.122180008477904778
73, 40.159837684964962534
74, 40.145443088096506301
75, 40.100327601234361907
76, 39.977911957045925817
77, 39.811887330645852501
78, 39.573863599401605029
79, 39.335617506360236462
];
linear_body_force_quadratic_tri = [
1, 42.057177348052455557
2, 42.19973966667958365
3, 42.210765313973496404
4, 42.213052753627735569
5, 42.213794472109462674
6, 42.21416935416691274
7, 42.214070605814029591
8, 42.214189818328172521
9, 42.213897084960457562
10, 42.212537041933252624
11, 42.21239511170340819
12, 42.205001388263120532
13, 42.189139296643524801
14, 42.178282174856896347
15, 42.156096729538568013
16, 42.062985632895383503
17, 41.690977685263213459
18, 41.220568613791613188
19, 40.901014791899832801
20, 40.328255471495147333
21, 40.052829638328432793
22, 40.399733955741353952
23, 40.842392254570853538
24, 40.715545797019892404
25, 40.100572290527232155
26, 39.391823580779345093
27, 38.824626657194436063
28, 37.447562357156634505
29, 36.08474440562628871
30, 34.922404079920134734
31, 34.086533066001770464
32, 33.906671284665968358
33, 32.946702416163098803
34, 32.304504562466675566
35, 31.791197111449999824
36, 31.300658787252281456
37, 30.726169312322639371
38, 30.1904143606250841
39, 29.571715173086996487
40, 29.038278764190017966
41, 28.21339754266388411
42, 27.175623386825595418
43, 26.195067705148250781
44, 25.56073727241228255
45, 25.157695575139012334
46, 24.97586084964265396
47, 24.948709823610069947
48, 24.997488975786495757
49, 25.037417702125896568
50, 25.01691127933405312
51, 24.903014032752359697
52, 24.695715547918755561
53, 24.353959717736898938
54, 23.796220475140266615
55, 23.17492517112538053
56, 22.552254305989034577
57, 21.923193753894317126
58, 21.295685784874628155
59, 20.666125188555387382
60, 20.074556477885021621
61, 19.510472272943207628
62, 18.922578137370329898
63, 18.320968319037014282
64, 17.723081641694925281
65, 17.145191717052387759
66, 16.60769992045614174
67, 16.101055350439835934
68, 15.606944219090150838
69, 15.130282727768229023
70, 14.677790145379386644
71, 14.246194212807216317
72, 13.838936708146613697
73, 13.452041114855285642
74, 13.072277423085271408
75, 12.695916940836326603
76, 12.311348706664945851
77, 11.912501391466957301
78, 11.506813971602614544
79, 11.109177007897264033
];
linear_body_force_quadratic_serendipity = [
1, 42.034231224325182552
2, 42.201788378037740301
3, 42.211697072276571419
4, 42.213466432904724002
5, 42.213972689110661918
6, 42.214160596334231457
7, 42.214243059136762781
8, 42.214287278352330191
9, 42.214306914325582909
10, 42.214323059460070908
11, 42.214332187204867353
12, 42.21433150542371493
13, 42.21433617200035826
14, 42.214331917028914631
15, 42.214336284307918845
16, 42.214374240841699759
17, 42.214404338578447096
18, 42.214367292244588725
19, 42.214262736773733309
20, 42.214286428444033561
21, 42.21434127855116003
22, 42.214344518717652477
23, 42.214341470201489415
24, 42.214336940993426595
25, 42.214342284421420004
26, 42.214319613094495764
27, 42.214354205024356759
28, 42.21430079881433528
29, 42.214289858460389837
30, 42.214288477177220216
31, 42.214181755253157746
32, 42.214060444696293928
33, 42.213904128181148678
34, 42.213934614417624402
35, 42.213959118029244166
36, 42.213733249600053909
37, 42.212577116152374401
38, 42.210351562368089162
39, 42.207607731615340185
40, 42.205173785164376454
41, 42.202172866746956004
42, 42.198471426436228171
43, 42.200132122589963046
44, 42.18608021809491504
45, 42.167816855247934882
46, 42.161723868573368179
47, 42.13966528229141062
48, 42.060254993830675119
49, 41.956996857761652109
50, 41.909499635127950512
51, 41.841831107079286767
52, 41.608182040184303219
53, 41.423845875439006647
54, 41.303569640367108207
55, 41.230807427543815891
56, 41.108136140694817584
57, 40.983311254929979839
58, 40.85520744097499346
59, 40.695921181795370103
60, 40.493135737789465622
61, 40.288527141639924878
62, 40.163646309134307444
63, 40.160303565127080105
64, 40.246961745289326018
65, 40.072729476460906994
66, 39.756628621160949422
67, 39.529980860521838792
68, 39.489004072404171097
69, 39.629422048053889682
70, 39.805855879628659011
71, 39.935145257667159058
72, 39.987757796767375851
73, 39.96920447795457676
74, 39.90444299319235455
75, 39.79137505259602392
76, 39.596716047128794003
77, 39.299139571834345475
78, 39.018032723351581126
79, 38.650049418978426274
];

larger_domain_linear_force = figure();
hold on
handle1 = plot(linear_body_force_quadratic_serendipity(:,1), linear_body_force_quadratic_serendipity(:,2), 'kd-');
set(handle1, 'linewidth', 2)
hold on
handle2 = plot(linear_body_force_quadratic_quad(:,1), linear_body_force_quadratic_quad(:,2), 'rd-');
set(handle2, 'linewidth', 2)
hold on
handle3 = plot(linear_body_force_linear_quad(:,1), linear_body_force_linear_quad(:,2), 'bd-');
set(handle3, 'linewidth', 2)
hold on
handle4 = plot(linear_body_force_quadratic_tri(:,1), linear_body_force_quadratic_tri(:,2), 'gd-');
set(handle4, 'linewidth', 2)
hold on
handle5 = plot(linear_body_force_linear_tri(:,1), linear_body_force_linear_tri(:,2), 'md-');
set(handle5, 'linewidth', 2)

set(gca, 'fontsize', 16)
title('Convergence for Linear Body Forces over 20x20 unit domain')
xlabel('1/h');
ylabel('Strain Energy');

legend('SerendipityQuad', 'QuadraticQuad', 'LinearQuad', 'QuadraticTri', 'LinearTri', 'Location', 'southeast');
ylim([32, 45]);