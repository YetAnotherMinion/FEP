clear
clc
close('all');

true_value = 0.0033034235538775347588 + 1e-14;

LinearQuad = [1, 0.00307795606197874827;
2, 0.0032012398488085879074;
3, 0.0032460179512662072111;
4, 0.0032669905584314651303;
5, 0.0032784198153966519727;
6, 0.0032853363255043810734;
7, 0.0032898166911597592939;
8, 0.0032928945309421814823;
9, 0.003295101327177538033;
10, 0.0032967205316322542238;
11, 0.0032979610873669481727;
12, 0.0032989437105869121557;
13, 0.0032996935950766388169;
14, 0.0033003125450385291904;
15, 0.0033008185866800899937;
16, 0.0033012268710696439193;
17, 0.0033015828432925945629;
18, 0.003301876896553649493;
19, 0.0033021264087365431554;
20, 0.0033023563741304546963;
21, 0.0033025349764740025496;
22, 0.0033027035869502056019;
23, 0.0033028529822277047714;
24, 0.0033029811068606479071;
25, 0.0033030952849919937957;
26, 0.0033031969162576964479;
27, 0.0033032868107514801702;
28, 0.0033033694316259771574;
29, 0.0033034181699052533009;
30, 0.0033034950773305239713;
31, 0.0033035598102043139783;
32, 0.0033036180931178345428;
33, 0.0033036702694911449819;
34, 0.0033037080922611559985;
35, 0.0033037283196437837972;
36, 0.003303730781019086158;
37, 0.0033037153302491284283;
38, 0.0033037193032964397126;
39, 0.0033037160188060712279;
40, 0.0033037238035327717335;
41, 0.0033036928423817541953;
42, 0.0033036346136822241325;
43, 0.0033035143353574709761;
44, 0.0033033942750734326434;
45, 0.0033033540963175035514;
46, 0.0033033148173765747475;
47, 0.0033033571040350863564;
48, 0.0033033259587808422308;
49, 0.0033034235538775347588 ];

QuadraticQuad = [
1, 0.0033018411083160885411;
2, 0.0033040797805787796952;
3, 0.0033043268739743050441;
4, 0.0033044238119337779325;
5, 0.0033044421669917042016;
6, 0.0033044873550554694497;
7, 0.0033044461369896565434;
8, 0.0033044682417990782312;
9, 0.0033044678691458570161;
10, 0.0033044540599760901384;
11, 0.0033044761267206563052;
12, 0.0033044723853653617217;
13, 0.0033044798803323143475;
14, 0.0033045721215689705802;
15, 0.0033045299640889719099;
16, 0.0033045068381323812294;
17, 0.0033044608745473290357;
18, 0.0033044753946781819237;
19, 0.0033044721752453066858;
20, 0.0033044500107730560672;
21, 0.0033044373615141145635;
22, 0.003304503393156783906;
23, 0.0033041118433325511287;
24, 0.0033039307925206494281;
25, 0.0033039738985727426686;
26, 0.0033038651987382307469;
27, 0.003303875358797198937;
28, 0.0033039935333388590483;
29, 0.0033038701879597653574;
30, 0.0033033249158996086034;
31, 0.0033024662089958045988;
32, 0.0033018789369994232079;
33, 0.003300463912704969336;
34, 0.0032965936095185107563;
35, 0.0032936126848599040461;
36, 0.0032907066437549365237;
37, 0.0032876152802393393548;
38, 0.0032830097466778457825;
39, 0.0032787063224386336739;
40, 0.0032728173486112981626;
41, 0.0032650831232649297348;
42, 0.003259329600567686773;
43, 0.0032548789924937465874;
44, 0.0032522019139316214915;
45, 0.0032549963048203811936;
46, 0.003262041365109425578;
47, 0.00327346422304562127;
48, 0.0032805381350232473009;
49, 0.0032766041441731831758];

LinearTri = [
1, 0.0031070481263745794789;
2, 0.003188118984689492473;
3, 0.003230484585712799922;
4, 0.0032540616589111456304;
5, 0.0032681702958308293805;
6, 0.003277238119935083592;
7, 0.0032833140454753555366;
8, 0.0032875828889727697936;
9, 0.0032906708999268122033;
10, 0.0032930096699277625234;
11, 0.0032947793284477271993;
12, 0.0032961653823414993787;
13, 0.0032973030116343294768;
14, 0.0032982040667485961263;
15, 0.0032989627529709324681;
16, 0.0032996066541606168011;
17, 0.0033001283430856452258;
18, 0.0033005893654700483621;
19, 0.0033009760244106902197;
20, 0.0033013472492424110472;
21, 0.003301542994459602965;
22, 0.0033014714143501482091;
23, 0.0033010214653602936059;
24, 0.0033010187380851266185;
25, 0.0033012029091532002489;
26, 0.0033013766455176900456;
27, 0.0033012720087398327029;
28, 0.0033013506360233344644;
29, 0.0033014878502508849742;
30, 0.0033013851021507674421;
31, 0.0033013397454291016145;
32, 0.0033021756141510261173;
33, 0.0033026551773211133486;
34, 0.0033027122363007877133;
35, 0.0033029425655242391005;
36, 0.0033028518133673477435;
37, 0.0033028624195440316191;
38, 0.0033029530389585642046;
39, 0.0033029210880484039664;
40, 0.0033026053915723549599;
41, 0.0033021456967367401707;
42, 0.0033017144324847961037;
43, 0.0033004402143378855188;
44, 0.0032997150350658967406;
45, 0.0032988897645980490986;
46, 0.0032968342895821306331;
47, 0.0032952358705803422821;
48, 0.0032930237132416093938;
49, 0.003289197934314581212 ];

QuadraticTri = [
1, 0.0032979363214041086325;
2, 0.0033033771658881254212;
3, 0.0033041600001692751805;
4, 0.0033043733519544748849;
5, 0.0033044355819800137579;
6, 0.0033045946985160736496;
7, 0.0033036765100035100917;
8, 0.0033034684845723145084;
9, 0.0033030255099074554669;
10, 0.0033034422055968270734;
11, 0.0033032641705456207946;
12, 0.0033033148608794340485;
13, 0.0033025812416414574574;
14, 0.0033005970310601277264;
15, 0.0032993952662733164356;
16, 0.003288484216908940834;
17, 0.0032652058566485968674;
18, 0.0032280603398283937676;
19, 0.0032121038150056918474;
20, 0.0031653857406080507415;
21, 0.0031539168538465326384;
22, 0.0031747165804711699987;
23, 0.0032166244310014393583;
24, 0.0031895250111335414836;
25, 0.0031222947715482006134;
26, 0.0030502222709280833561;
27, 0.0029668635611664272676;
28, 0.0028854736380819652475;
29, 0.0028291620054055181301;
30, 0.0028002367852022341799;
31, 0.0027556570032431062026;
32, 0.0026951872046589030359;
33, 0.0026443519490640166915;
34, 0.0025975847387272716325;
35, 0.0025511046026420671103;
36, 0.0024992956319834663294;
37, 0.0024386103821850886077;
38, 0.0023725765126730875149;
39, 0.0022958299015565131369;
40, 0.0021966083974659976821;
41, 0.0020892240367134792475;
42, 0.0020024351443383645033;
43, 0.0019205694203799558977;
44, 0.0018434096313151126633;
45, 0.0017766645702420424523;
46, 0.0017132275818346795037;
47, 0.0016506926834508907614;
48, 0.0015916590093849115103;
49, 0.001543554634390602049];

SerendipityQuad = [
1, 0.0033016272860576551147;
2, 0.003304027103719380052;
3, 0.0033043085711936658749;
4, 0.0033044321842415494764;
5, 0.0033044354350770807974;
6, 0.0033044527148084899999;
7, 0.0033044285753108400792;
8, 0.0033044587924768182435;
9, 0.0033044877775371085324;
10, 0.0033044827744622240311;
11, 0.0033045161169327347261;
12, 0.0033044459889621357468;
13, 0.0033044826824383203429;
14, 0.003304473901239792042;
15, 0.0033044859588792952106;
16, 0.0033044458872444324761;
17, 0.0033045009391487133697;
18, 0.0033044179811430249294;
19, 0.0033042978325973932502;
20, 0.0033042243355906135947;
21, 0.0033040565726605974212;
22, 0.0033037827839555089157;
23, 0.0033038310253644975235;
24, 0.0033037088047520903056;
25, 0.0033036959546247088651;
26, 0.003303551433079115595;
27, 0.003303527992647412731;
28, 0.0033038617961222665857;
29, 0.0033041076592818046341;
30, 0.0033042333726438872718;
31, 0.0033041587251823305998;
32, 0.0033040980909073178022;
33, 0.0033038670895043495065;
34, 0.0033035588929522944138;
35, 0.0033035258760391364961;
36, 0.0033035595551971419157;
37, 0.0033036513050522095178;
38, 0.0033035505436280585174;
39, 0.0033030945150333010721;
40, 0.0033024111679862081653;
41, 0.0033017659761783767561;
42, 0.0033010591366159887719;
43, 0.0033008337509927662169;
44, 0.003299606288220195173;
45, 0.0032971253946634982053;
46, 0.0032910568489568177084;
47, 0.0032828085177038519166;
48, 0.003274533687600986176;
49, 0.0032677781884571767759 ];

strain_energy_fig = figure();
hold on
handle1 = plot(SerendipityQuad(:,1), SerendipityQuad(:,2), 'kd-');
set(handle1, 'linewidth', 2)
hold on
handle2 = plot(QuadraticQuad(:,1), QuadraticQuad(:,2), 'rd-');
set(handle2, 'linewidth', 2)
hold on
handle3 = plot(LinearQuad(:,1), LinearQuad(:,2), 'bd-');
set(handle3, 'linewidth', 2)
hold on
handle4 = plot(QuadraticTri(:,1), QuadraticTri(:,2), 'gd-');
set(handle4, 'linewidth', 2)
hold on
handle5 = plot(LinearTri(:,1), LinearTri(:,2), 'md-');
set(handle5, 'linewidth', 2)

set(gca, 'fontsize', 16)
title('Convergence for Constant Body Forces')
xlabel('h');
ylabel('Strain Energy');

legend('SerendipityQuad', 'QuadraticQuad', 'LinearQuad', 'QuadraticTri', 'LinearTri', 'Location', 'southeast');
ylim([0.003, 0.00335]);

